// LSF-specific Nextflow configuration for running on LSF cluster
profiles {
    lsf {
            // Executor and LSF settings
            process.executor        = 'lsf'
            
            // Dynamic queue selection based on job requirements
            // Similar to nf-core/configs mssm profile: https://nf-co.re/configs/mssm/
            process.queue = { task.time >= 8.h ? 'long' : 'short' }
            

            // Maximum resource limits per job (caps)
            process.resourceLimits = [
                cpus: 32,
                memory: 512.GB,
                time: 10.d
            ]

            // singularity cache directory
            singularity.cacheDir = launchDir + '/singularity/cache'
            
            // pull timeout
            singularity.pullTimeout = 120.min

            // Container runtime (LSF typically uses Singularity)
            singularity.enabled    = true
            singularity.autoMounts = true
            docker.enabled          = false
            podman.enabled          = false
            shifter.enabled         = false
            charliecloud.enabled    = false
            apptainer.enabled       = false
            conda.enabled           = false

            //cluster options
            clusterOptions = {
                // Handle memory requests - ensure consistency between -M and rusage
                if (task.memory) {
                    def mem = task.memory.toMega()
                    options += " -M ${mem}"
                }
                return options
            }
       }
}


